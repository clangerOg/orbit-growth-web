import { getOGProject } from '@/lib/sanity/sanity.methods';
import { Project } from '@/lib/sanity/types/project.type';
import { ImageResponse } from 'next/server';

// Route segment config
export const runtime = 'edge';

// Image metadata
export const alt = 'About Acme';
export const size = {
  width: 1200,
  height: 630,
};
export const contentType = 'image/png';

// Image generation
export default async function Image({ params }: { params: { slug: string } }) {
  const project: Pick<Project, 'title'> = await getOGProject(params.slug);

  return new ImageResponse(
    (
      // ImageResponse JSX element
      <div
        style={{
          height: '100%',
          width: '100%',
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'flex-start',
          justifyContent: 'flex-start',
          backgroundColor: '#fff',
          fontSize: 32,
          fontWeight: 600,
          padding: '80px',
        }}
      >
        <div
          style={{
            display: 'flex',
          }}
        >
          <svg
            width="200"
            height="42"
            viewBox="0 0 200 42"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clipPath="url(#clip0_308_443)">
              <path
                d="M79.0955 20.4837C79.0955 22.1951 78.7749 23.661 78.1338 24.8812C77.4978 26.0962 76.6292 27.0269 75.5279 27.6732C74.4317 28.3195 73.1882 28.6427 71.7974 28.6427C70.4065 28.6427 69.1605 28.3195 68.0592 27.6732C66.963 27.0218 66.0944 26.0885 65.4532 24.8734C64.8173 23.6532 64.4993 22.19 64.4993 20.4837C64.4993 18.7723 64.8173 17.309 65.4532 16.094C66.0944 14.8738 66.963 13.9405 68.0592 13.2942C69.1605 12.6479 70.4065 12.3247 71.7974 12.3247C73.1882 12.3247 74.4317 12.6479 75.5279 13.2942C76.6292 13.9405 77.4978 14.8738 78.1338 16.094C78.7749 17.309 79.0955 18.7723 79.0955 20.4837ZM76.2026 20.4837C76.2026 19.279 76.0139 18.263 75.6365 17.4357C75.2642 16.6033 74.7471 15.9751 74.0853 15.5511C73.4235 15.1219 72.6609 14.9074 71.7974 14.9074C70.9339 14.9074 70.1713 15.1219 69.5095 15.5511C68.8476 15.9751 68.328 16.6033 67.9506 17.4357C67.5783 18.263 67.3922 19.279 67.3922 20.4837C67.3922 21.6884 67.5783 22.707 67.9506 23.5395C68.328 24.3667 68.8476 24.9949 69.5095 25.4241C70.1713 25.8481 70.9339 26.0601 71.7974 26.0601C72.6609 26.0601 73.4235 25.8481 74.0853 25.4241C74.7471 24.9949 75.2642 24.3667 75.6365 23.5395C76.0139 22.707 76.2026 21.6884 76.2026 20.4837ZM81.6917 28.4255V16.5128H84.414V18.4983H84.5381C84.7552 17.8106 85.1275 17.2806 85.6549 16.9083C86.1874 16.5309 86.795 16.3422 87.4775 16.3422C87.6326 16.3422 87.8058 16.3499 87.9971 16.3654C88.1936 16.3758 88.3564 16.3939 88.4857 16.4197V19.0024C88.3668 18.961 88.1781 18.9248 87.9195 18.8938C87.6662 18.8576 87.4206 18.8395 87.1827 18.8395C86.6709 18.8395 86.2107 18.9507 85.8022 19.173C85.3989 19.3902 85.081 19.6926 84.8483 20.0804C84.6156 20.4682 84.4993 20.9154 84.4993 21.4221V28.4255H81.6917ZM90.475 28.4255V12.5419H93.2826V18.4827H93.3989C93.5437 18.1932 93.7479 17.8856 94.0116 17.5598C94.2753 17.2289 94.6321 16.9471 95.0819 16.7144C95.5317 16.4766 96.1057 16.3577 96.8037 16.3577C97.724 16.3577 98.5539 16.5929 99.2933 17.0635C100.038 17.5288 100.627 18.219 101.062 19.1342C101.501 20.0442 101.721 21.161 101.721 22.4847C101.721 23.7928 101.506 24.9045 101.077 25.8196C100.648 26.7348 100.064 27.4328 99.3243 27.9137C98.5849 28.3945 97.7473 28.6349 96.8114 28.6349C96.1289 28.6349 95.5628 28.5212 95.1129 28.2937C94.6631 28.0662 94.3012 27.7922 94.0271 27.4716C93.7583 27.1458 93.5489 26.8382 93.3989 26.5487H93.2361V28.4255H90.475ZM93.2283 22.4692C93.2283 23.2396 93.3369 23.9143 93.554 24.4934C93.7764 25.0725 94.0944 25.5249 94.508 25.8506C94.9268 26.1712 95.4335 26.3315 96.0281 26.3315C96.6486 26.3315 97.1682 26.166 97.587 25.8351C98.0058 25.4991 98.3212 25.0415 98.5332 24.4624C98.7504 23.8781 98.8589 23.2137 98.8589 22.4692C98.8589 21.7298 98.7529 21.0731 98.541 20.4992C98.329 19.9253 98.0136 19.4755 97.5948 19.1497C97.1759 18.824 96.6537 18.6611 96.0281 18.6611C95.4283 18.6611 94.919 18.8188 94.5002 19.1342C94.0814 19.4496 93.7634 19.8917 93.5463 20.4604C93.3343 21.0292 93.2283 21.6988 93.2283 22.4692ZM104.108 28.4255V16.5128H106.915V28.4255H104.108ZM105.519 14.8221C105.074 14.8221 104.692 14.6747 104.371 14.38C104.051 14.0801 103.89 13.7207 103.89 13.3019C103.89 12.878 104.051 12.5186 104.371 12.2239C104.692 11.924 105.074 11.7741 105.519 11.7741C105.969 11.7741 106.352 11.924 106.667 12.2239C106.988 12.5186 107.148 12.878 107.148 13.3019C107.148 13.7207 106.988 14.0801 106.667 14.38C106.352 14.6747 105.969 14.8221 105.519 14.8221ZM115.751 16.5128V18.6844H108.903V16.5128H115.751ZM110.593 13.6587H113.401V24.8424C113.401 25.2199 113.458 25.5094 113.571 25.711C113.69 25.9075 113.846 26.042 114.037 26.1143C114.228 26.1867 114.44 26.2229 114.673 26.2229C114.849 26.2229 115.009 26.21 115.154 26.1841C115.304 26.1583 115.417 26.135 115.495 26.1143L115.968 28.3092C115.818 28.3609 115.603 28.4178 115.324 28.4798C115.05 28.5419 114.714 28.5781 114.316 28.5884C113.613 28.6091 112.979 28.5031 112.416 28.2704C111.852 28.0326 111.405 27.6655 111.074 27.1691C110.748 26.6728 110.588 26.0523 110.593 25.3077V13.6587ZM134.281 17.6141C134.152 17.1953 133.973 16.8204 133.746 16.4895C133.524 16.1535 133.255 15.8665 132.939 15.6286C132.629 15.3908 132.272 15.2124 131.869 15.0935C131.466 14.9694 131.026 14.9074 130.551 14.9074C129.697 14.9074 128.937 15.1219 128.27 15.5511C127.603 15.9802 127.079 16.611 126.696 17.4435C126.319 18.2708 126.13 19.279 126.13 20.4682C126.13 21.6677 126.319 22.6837 126.696 23.5162C127.073 24.3486 127.598 24.982 128.27 25.4163C128.943 25.8455 129.723 26.0601 130.613 26.0601C131.419 26.0601 132.117 25.9049 132.707 25.5947C133.301 25.2845 133.759 24.845 134.079 24.2762C134.4 23.7023 134.56 23.0302 134.56 22.2598L135.212 22.3606H130.9V20.1114H137.345V22.0193C137.345 23.3792 137.055 24.5554 136.476 25.5482C135.897 26.5409 135.101 27.3061 134.087 27.8439C133.074 28.3764 131.91 28.6427 130.597 28.6427C129.134 28.6427 127.849 28.3144 126.743 27.6577C125.641 26.9959 124.78 26.0575 124.16 24.8424C123.545 23.6222 123.237 22.1745 123.237 20.4992C123.237 19.2169 123.418 18.0717 123.78 17.0635C124.147 16.0552 124.659 15.1995 125.316 14.4963C125.972 13.788 126.743 13.2502 127.627 12.8831C128.511 12.5109 129.473 12.3247 130.512 12.3247C131.391 12.3247 132.21 12.454 132.97 12.7125C133.73 12.9659 134.405 13.3278 134.995 13.7983C135.589 14.2688 136.078 14.8272 136.46 15.4735C136.843 16.1198 137.094 16.8334 137.213 17.6141H134.281ZM140.003 28.4255V16.5128H142.725V18.4983H142.849C143.066 17.8106 143.439 17.2806 143.966 16.9083C144.499 16.5309 145.106 16.3422 145.789 16.3422C145.944 16.3422 146.117 16.3499 146.308 16.3654C146.505 16.3758 146.668 16.3939 146.797 16.4197V19.0024C146.678 18.961 146.489 18.9248 146.231 18.8938C145.977 18.8576 145.732 18.8395 145.494 18.8395C144.982 18.8395 144.522 18.9507 144.113 19.173C143.71 19.3902 143.392 19.6926 143.159 20.0804C142.927 20.4682 142.81 20.9154 142.81 21.4221V28.4255H140.003ZM153.368 28.6582C152.205 28.6582 151.196 28.4023 150.343 27.8904C149.49 27.3785 148.828 26.6624 148.358 25.7421C147.892 24.8217 147.66 23.7463 147.66 22.5157C147.66 21.2851 147.892 20.2071 148.358 19.2816C148.828 18.3561 149.49 17.6374 150.343 17.1255C151.196 16.6136 152.205 16.3577 153.368 16.3577C154.531 16.3577 155.539 16.6136 156.393 17.1255C157.246 17.6374 157.905 18.3561 158.37 19.2816C158.841 20.2071 159.076 21.2851 159.076 22.5157C159.076 23.7463 158.841 24.8217 158.37 25.7421C157.905 26.6624 157.246 27.3785 156.393 27.8904C155.539 28.4023 154.531 28.6582 153.368 28.6582ZM153.383 26.4091C154.014 26.4091 154.542 26.2358 154.966 25.8894C155.39 25.5378 155.705 25.0673 155.912 24.4779C156.124 23.8885 156.23 23.2318 156.23 22.5079C156.23 21.7789 156.124 21.1197 155.912 20.5302C155.705 19.9356 155.39 19.4625 154.966 19.111C154.542 18.7594 154.014 18.5836 153.383 18.5836C152.737 18.5836 152.199 18.7594 151.77 19.111C151.346 19.4625 151.028 19.9356 150.816 20.5302C150.609 21.1197 150.506 21.7789 150.506 22.5079C150.506 23.2318 150.609 23.8885 150.816 24.4779C151.028 25.0673 151.346 25.5378 151.77 25.8894C152.199 26.2358 152.737 26.4091 153.383 26.4091ZM163.576 28.4255L160.21 16.5128H163.072L165.166 24.8889H165.275L167.415 16.5128H170.246L172.387 24.8424H172.503L174.566 16.5128H177.436L174.062 28.4255H171.138L168.904 20.3751H168.742L166.508 28.4255H163.576ZM185.345 16.5128V18.6844H178.496V16.5128H185.345ZM180.187 13.6587H182.995V24.8424C182.995 25.2199 183.051 25.5094 183.165 25.711C183.284 25.9075 183.439 26.042 183.631 26.1143C183.822 26.1867 184.034 26.2229 184.267 26.2229C184.442 26.2229 184.603 26.21 184.747 26.1841C184.897 26.1583 185.011 26.135 185.089 26.1143L185.562 28.3092C185.412 28.3609 185.197 28.4178 184.918 28.4798C184.644 28.5419 184.308 28.5781 183.91 28.5884C183.207 28.6091 182.573 28.5031 182.01 28.2704C181.446 28.0326 180.999 27.6655 180.668 27.1691C180.342 26.6728 180.182 26.0523 180.187 25.3077V13.6587ZM190.756 21.4454V28.4255H187.949V12.5419H190.694V18.537H190.834C191.113 17.8649 191.545 17.3349 192.129 16.9471C192.718 16.5542 193.468 16.3577 194.378 16.3577C195.205 16.3577 195.927 16.5309 196.542 16.8773C197.157 17.2237 197.633 17.7304 197.969 18.3974C198.31 19.0644 198.481 19.8788 198.481 20.8405V28.4255H195.673V21.2748C195.673 20.4734 195.466 19.8503 195.053 19.4057C194.644 18.9558 194.07 18.7309 193.331 18.7309C192.835 18.7309 192.39 18.8395 191.997 19.0567C191.609 19.2687 191.304 19.5763 191.082 19.9796C190.865 20.3829 190.756 20.8715 190.756 21.4454Z"
                fill="#1B1B1B"
              />
              <circle
                cx="20.9664"
                cy="20.9664"
                r="18.8698"
                stroke="#1B1B1B"
                strokeWidth="4.19328"
              />
              <path
                d="M41.9328 20.9664C41.9328 32.5459 32.5459 41.9328 20.9664 41.9328V20.9664H0C0 9.38699 9.38699 0 20.9664 0C32.5459 0 41.9328 9.38699 41.9328 20.9664Z"
                fill="#1B1B1B"
              />
            </g>
            <defs>
              <clipPath id="clip0_308_443">
                <rect width="200" height="41.9328" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </div>
        <div
          style={{
            flexGrow: '1',
          }}
        />

        <div
          style={{
            color: '#0f172a',
          }}
        >
          {project.title}
        </div>
      </div>
    ),
    // ImageResponse options
    {
      // For convenience, we can re-use the exported opengraph-image
      // size config to also set the ImageResponse's width and height.
      ...size,
    }
  );
}
